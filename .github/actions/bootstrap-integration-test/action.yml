name: "Bootstrap Integration Test"
description: "Sets up an environment for our integration tests"
inputs:
  fastly-version:
    description: "The version of the Fastly CLI to install"
    required: true
    default: "10.2.2"
  viceroy-version:
    description: "The version of Viceroy to install"
    required: true
    default: "0.6.0"
runs:
  using: "composite"
  steps:
    - run: |
        echo "Install Fastly CLI ${{ inputs.fastly-version }}..."
        wget https://github.com/fastly/cli/releases/download/v${{ inputs.fastly-version }}/fastly_${{ inputs.fastly-version }}_linux_amd64.deb
        sudo apt install ./fastly_${{ inputs.fastly-version }}_linux_amd64.deb
      shell: "bash"
    - run: |
        echo "Install Viceroy ${{ inputs.viceroy-version }}..."
        wget https://github.com/fastly/Viceroy/releases/download/v${{ inputs.viceroy-version }}/viceroy_v${{ inputs.viceroy-version }}_linux-amd64.tar.gz
        mkdir -p $HOME/bin
        tar -xzf viceroy_v${{ inputs.viceroy-version }}_linux-amd64.tar.gz --directory $HOME/bin
        echo "$HOME/bin" >> $GITHUB_PATH
      shell: "bash"
